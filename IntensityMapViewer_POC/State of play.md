## State of play

Steve T, end of Jan 2021

Miscellaneous thoughts on how the POC has been going, and where we are.

#### Building an Uno project

It's exceedingly fiddly to set up an Uno project at the moment, involving a lot of arcane knowledge of how to manually edit the project-definition files. Needs a 'Matteo' level of expertise and dogged patience ! This problem will go away once there are 'templates' available to set up the project structure, but today it's a world of pain and confusion. To be fair though, we are perhaps being ambitious in (A) using MVVM and (B) doing graphics with Skia.

The internals of the 'build process' are phenomenally complex - hats off to Jerome et al for making it work, at all!. But consequently we're getting exposed to 'unresolved issues' in Visual Studio. The situation has improved a bit with the latest VS preview, but prior to that there were so many problems with the IDE that it was not usable ; too many spurious errors (some of which went away if you waited long enough) and exhorbitantly long build times. I reverted to getting code working in a native UWP app, and then migrating it to the Uno project.

Skia has been the right choice for implementing the graphics. Again, migrating the UWP-oriented code to work in Uno (supporting Windows/UWP, Android, WASM and Linux) is taking some heroic knowledge on Matteo's part (!!) but we're getting there. The 'rendering' parts of Skia work great, the only issues are around user interactions with mouse and touch events.

I had some trouble setting up the WSL environment necessary for WASM, but after quite a bit of fiddling that seems to work OK now. Not quite sure what I did though.

#### Uwp vs WinUI

We're fine with basing the POC on UWP, but just to be clear, we can't be using UWP apps going forward.

Given the fiddliness of setting up the projects, is it worth putting things on hold for a bit until mid March (?) when a WinUI version of Uno might be available ? 

#### MVVM frameworks

Initially thought the Community Toolkit MVVM framework was the no-brainer best way to go, and the IntensityMap ViewModel classes are currently still using this (it works fine).

When we started to build the skeleton for the POC, we started with the code generated by the Windows Template Studio, using MVVM-Light, as the Community Toolkit isn't currently supported. Fair enough. That solution turned out to have some thorny issues involving circular references, which were neatly solved by migrating to Prism. Prism gives us a very nice modular architecture which will be well worth adopting for complex apps that we'll write in future, so it seems well worthwhile going up the learning curve.

Prism is no longer supported on UWP, for somewhat worrying reasons as explained by the main authors in this post :

  Prism - Is UWP support drop permanent ?
  https://github.com/PrismLibrary/Prism/issues/1835

From which I quote :
- Currently their UWP platform does not meet the architectural requirements for Prism to support it. Everything from their threading model, to their navigation, it just isn't built to properly write clean and maintainable applications (Brian Lagunas).
- Until recently, Prism supported UWP. Why discontinue an existing codebase ?
  Because it was truly that bad. It required a full rewrite.
- For WPF and Xamarin.Forms apps Prism continues and will continue to be the best MVVM Framework available to developers. We don't want to put something out that kinda works but really isn't top notch for UWP.

Given that we want to be using WinUI absolutely as soon as it's out of Preview (due middle of March) and that the WinUI API's are essentially the same as UWP ... let's just check that an Uno/WinUI version of Prism is going to be the proper choice, in the light of the comments above. 




